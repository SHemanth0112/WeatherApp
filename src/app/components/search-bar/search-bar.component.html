<div class="search-container">
  <div class="search-form">
    <div class="input-group">
      <input
        #cityInput
        type="text"
        [value]="cityName"
        (keypress)="onKeyPress($event)"
        (input)="onInputChange(cityInput.value)"
        [class.invalid]="!isValid"
        placeholder="Enter city name (e.g., London, Paris, Tokyo)"
        class="input"
        aria-label="City name"
        aria-describedby="error-message"
        autocomplete="off"
      />
      <button
        type="button"
        (click)="onSearch()"
        [disabled]="!cityName.trim()"
        class="btn"
        aria-label="Search weather"
      >
        <span class="search-icon">ğŸ”</span>
        Search
      </button>
      <button
        *ngIf="cityName"
        type="button"
        (click)="clearInput()"
        class="btn btn-secondary btn-small"
        aria-label="Clear search"
        title="Clear search"
      >
        âœ•
      </button>
    </div>
  
    <ul class="suggestions" *ngIf="suggestions$ | async as suggestions" role="listbox" [attr.aria-expanded]="(suggestions?.length ?? 0) > 0">
      <li
        *ngFor="let s of suggestions"
        (click)="onSelectSuggestion(s)"
        class="suggestion-item"
        role="option"
        [attr.aria-label]="s.state ? s.name + ', ' + s.state + ', ' + s.country : s.name + ', ' + s.country"
      >
        <span class="city">{{ s.name }}</span>
        <span class="meta">{{ s.state ? s.state + ', ' : ''}}{{ s.country }}</span>
      </li>
    </ul>

    <div 
      *ngIf="!isValid && errorMessage" 
      id="error-message" 
      class="error-message"
      role="alert"
      aria-live="polite"
    >
      {{ errorMessage }}
    </div>
  </div>
</div>
